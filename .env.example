# ============================================================================
# .env.example — aumos-security-runtime
# ============================================================================
# Copy to .env and customize for local development:
#   cp .env.example .env
# ============================================================================

# Service Identity
AUMOS_SERVICE_NAME=aumos-security-runtime
AUMOS_ENVIRONMENT=development
AUMOS_DEBUG=true

# Database (PostgreSQL 16 + pgvector + RLS)
AUMOS_DATABASE__URL=postgresql+asyncpg://aumos:aumos_dev@localhost:5432/aumos
AUMOS_DATABASE__POOL_SIZE=10
AUMOS_DATABASE__ECHO=false

# Kafka (Apache Kafka + Protobuf Schema Registry)
AUMOS_KAFKA__BROKERS=localhost:9092
AUMOS_KAFKA__SCHEMA_REGISTRY_URL=http://localhost:8081

# Authentication (Keycloak)
AUMOS_KEYCLOAK__URL=http://localhost:8080
AUMOS_KEYCLOAK__REALM=aumos
AUMOS_KEYCLOAK__CLIENT_ID=aumos-security-runtime
AUMOS_KEYCLOAK__CLIENT_SECRET=dev-secret-change-in-production

# Observability
AUMOS_OTEL_ENDPOINT=http://localhost:4317
AUMOS_OTEL_ENABLED=false
AUMOS_LOG_LEVEL=DEBUG
AUMOS_LOG_FORMAT=console

# Secrets (OpenBao / Vault)
AUMOS_VAULT__URL=http://localhost:8200
AUMOS_VAULT__TOKEN=dev-root-token

# Redis (used for distributed pattern cache)
AUMOS_REDIS__URL=redis://localhost:6379/0

# Object Storage (MinIO)
AUMOS_MINIO__URL=http://localhost:9000
AUMOS_MINIO__ACCESS_KEY=minioadmin
AUMOS_MINIO__SECRET_KEY=minioadmin
AUMOS_MINIO__DEFAULT_BUCKET=aumos-artifacts

# ============================================================================
# SECURITY RUNTIME SETTINGS (prefix: AUMOS_SECRUNTIME_)
# ============================================================================

# Core latency budget — hard limit in milliseconds for input scans
AUMOS_SECRUNTIME_MAX_LATENCY_MS=50

# Pattern scanner — LRU cache size for compiled regex patterns
AUMOS_SECRUNTIME_PATTERN_CACHE_SIZE=1000

# Tenant policy cache TTL in seconds (avoid DB hit on every request)
AUMOS_SECRUNTIME_POLICY_CACHE_TTL_SECONDS=60

# ML scanner — set to path of fine-tuned model, or leave blank for base spaCy model
AUMOS_SECRUNTIME_ML_MODEL_PATH=

# PII detection — minimum Presidio confidence score (0.0-1.0)
AUMOS_SECRUNTIME_PII_CONFIDENCE_THRESHOLD=0.7

# Trivy container scanning — endpoint for Trivy server (leave blank to disable)
AUMOS_SECRUNTIME_TRIVY_ENDPOINT=

# Feature flags — disable ML scanner in resource-constrained environments
AUMOS_SECRUNTIME_ENABLE_ML_SCANNER=true
AUMOS_SECRUNTIME_ENABLE_PII_SCANNER=true
AUMOS_SECRUNTIME_ENABLE_CONTAINER_SCANNER=false

# Prompt injection ML threshold — confidence above which to block
AUMOS_SECRUNTIME_INJECTION_BLOCK_THRESHOLD=0.85
AUMOS_SECRUNTIME_INJECTION_WARN_THRESHOLD=0.60
